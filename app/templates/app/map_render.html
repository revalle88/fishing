<script>
ymaps.ready(init);
var myMap;
var a = "{% url 'pounds' %}";
function init () {
    myMap = new ymaps.Map("map", {
        center: [57.5262, 38.3061], // Углич
        zoom: 11
    }, {
        balloonMaxWidth: 200,
        searchControlProvider: 'yandex#search'
    }),

    myMap.geoObjects
        {% for review in reviews %}
        .add(new ymaps.Placemark([{{review.lang}}, {{review.lat}}], {
            balloonContent: "{{review.created_date}}<br><a href = {% url 'review_show' review.id %}>инфо</a>"
        }, {
            preset: 'islands#icon',
            iconColor: '#0095b6'
        }))
        {% endfor %}





    // Обработка события, возникающего при щелчке
    // левой кнопкой мыши в любой точке карты.
    // При возникновении такого события откроем балун.
    myMap.events.add('click', function (e) {

        document.getElementById('new_point').style.display = 'block';
        if (!myMap.balloon.isOpen()) {
            var coords = e.get('coords');
            var myurl = "{% url 'review_new' %}"+"?lat="+coords[0]+"&lang="+coords[1]

            myMap.balloon.open(coords, {
                contentHeader:'Событие!',
                contentBody:
                    '<p>Координаты щелчка: ' + [
                    coords[0].toPrecision(6),
                    coords[1].toPrecision(6)
                    ].join(', ') + '</p>',
                contentFooter: "<a href="+myurl+">add point</a>"
            });
        }
        else {
            myMap.balloon.close();
        }
    });

    // Обработка события, возникающего при щелчке
    // правой кнопки мыши в любой точке карты.
    // При возникновении такого события покажем всплывающую подсказку
    // в точке щелчка.
    myMap.events.add('contextmenu', function (e) {
        myMap.hint.open(e.get('coords'), 'Кто-то щелкнул правой кнопкой');
    });

    // Скрываем хинт при открытии балуна.
    myMap.events.add('balloonopen', function (e) {
        myMap.hint.close();
    });






}

</script>


